---
layout: $/layouts/post.astro
title: Avril 2023
description: Monthly Avril 2023
tags: 
  - monthly
  - delicorner
date: 2023-04-01
---

# Month

- Intégration
- Dockerisation des projets
- Réinitialisation du mot de passe

# Weeks

## Semaine 14

- Intégration
- Dockerisation des projets
  - API - Nodejs
  - Front - Vuejs

## Semaine 15

- Réinitialisation du mot de passe
  - Front
  - API
  - Plateforme

# Days

## Lundi 03

- Rencontre des équipes sur Paris.
- Visite des locaux
- Récupération du matériel
- Présentation des outils et des méthodes de travail
- Présentation des projets
- Installation du projet `plateforme`

## Mardi 04

- Finalisation de l'installation du PC
  - Programmes
  - Personnalisation
  - Changement d'username
- `PF-109: Docker - Créer un Docker API`
  - Démarrage du projet
  - L'API se lance et répond
  - L'IP du container est bien pingable depuis le container `pf-php`
  - Erreur de connexion à la DB

## Mercredi 05 et Jeudi 06

- `PF-109: Docker - Créer un Docker API`
  - Problème de connexion à la DB réglé
    - Problème de port
  - Interconnexion des containers
    - `pf-php` peut ping `api`
    - `api` peut ping `pf-php`

> **Ce qui m'a posé problème:**
> Le test depuis l'appli `plateforme` lançait une requête sur la route `/deliveryImages` de l'API.
> Cet appel me déclenchait une erreur **ECONNREFUSED**.
> J'ai donc passé pas mal de temps à essayer de trouver d'où venait le problème.
> Mais finalement, après avoir testé d'autres appels (`/categories`), je me suis rendu compte que la route `/deliveryImages` faisait elle-même appel à l'API de **MyTroopers**.

  - L'API est bien accessible depuis l'app `plateforme`
  - MR créée pour `PF-109`
  - Réinstallation du projet `plateforme` → cause problème de Git
    - _error updating changes detected dubious ownership_

## Vendredi 07

- `PF-119: Docker - Créer le docker du Front`
  - Front =
    - appli utilisée par les clients
    - développée en Vuejs
  - Démarrage du projet
  - Installation en local
  - Dockerize
    - Création du Dockerfile
    - Création du docker-compose
    - Lancement du container
    - L'appli se lance et répond


## Mardi 11

- `PF-159: Front Client - Réinitialisation autonome du MDP`
- Weekly

## Mercredi 12

- `PF-159: Front Client - Réinitialisation autonome du MDP`
- Réunion avec Alexis pour la présentation des projets
- `PF-160: PF - Réinitialisation autonome du MDP`
- Ajout de Xdebug au container `pf-php`

## Jeudi 13

- `PF-160: PF - Réinitialisation autonome du MDP`
  - La feature existe déjà
  - Non fonctionnelle à cause de l'activityBundle
    - Il cherche l'`id` et l'`username` de l'utilisateur qui fait l'action dans le token
    - Mais l'user n'étant pas encore connecté, l'user est _anonymous_.
    - Donc pas d'`id` et pas d'`username` (voir extrait de code ci-dessous)
  - Sur la page de réinitialisation, on n'a qu'un champ _mot de passe_
  - Ajout d'un second champ _confirmation du mot de passe_ 
  
~~~php
$id = $token instanceof TokenInterface ? $token->getUser()->getId() : 0;
$username = $token instanceof TokenInterface ? $token->getUser()->getUsername() : 'cron';
~~~

### Pour le déploiement

#### Plateforme

Ajouter les variables d'environnement suivantes avec les bonnes valeurs :

- SYMFONY__API_HOST
- SYMFONY__API_PORT
